<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>تسجيل / دخول — Mega-Bot</title>
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');
/* لوّن العلامة التجارية بما يناسب الخلفية */
:root{
  --brand-start: #7a3d85;  /* بنفسجي غامق قريب من الموج */
  --brand-end:   #b268c5;  /* بنفسجي وردي فاتح */
  --brand:       #8a54b9;  /* للزر الصلب */
}

/* بدّل الأزرق في اللوحة المنحنية إلى تدرّج بنفسجي */
.toggle-box::before{
  background: linear-gradient(135deg, var(--brand-start), var(--brand-end)) !important;
  filter: drop-shadow(0 10px 30px rgba(138,84,185,.35));
}

/* وحّد لون الأزرار مع العلامة الجديدة */
.btn{
  background: var(--brand) !important;
  box-shadow: 0 0 10px rgba(138,84,185,.18);
}

/* (اختياري) تدرّج خفيف لزر التحويل في اللوحات */
.toggle-panel .btn{
  border-color:#fff !important;
  background: transparent !important;
}

/* (اختياري) عند التحويم على الأزرار */
.btn:hover{
  filter: brightness(1.06);
}

    /* ======= (شفرتك الأصلية كما هي) ======= */
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;text-decoration:none;list-style:none;}
    body{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(90deg,#e2e2e2,#c9d6ff);color:#333;}

    .container{position:relative;width:850px;height:550px;background:#fff;margin:20px;border-radius:30px;box-shadow:0 0 30px rgba(0,0,0,.2);overflow:hidden;}
    .container h1{font-size:36px;margin:-10px 0;}
    .container p{font-size:14.5px;margin:15px 0;}

    form{width:100%;}
    .form-box{position:absolute;right:0;width:50%;height:100%;background:#fff;display:flex;align-items:center;color:#333;text-align:center;padding:40px;z-index:1;transition:.6s ease-in-out 1.2s,visibility 0s 1s;}
    .container.active .form-box{right:50%;}
    .form-box.register{visibility:hidden;}
    .container.active .form-box.register{visibility:visible;}

    .input-box{position:relative;margin:30px 0;}
    .input-box input{width:100%;padding:13px 50px 13px 20px;background:#eee;border-radius:8px;border:none;outline:none;font-size:16px;color:#333;font-weight:500;}
    .input-box input::placeholder{color:#888;font-weight:400;}
    .input-box i{position:absolute;right:20px;top:50%;transform:translateY(-50%);font-size:20px;}

    .forgot-link{margin:-15px 0 15px;}
    .forgot-link a{font-size:14.5px;color:#333;}

    .btn{width:100%;height:48px;background:#7494ec;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,.1);border:none;cursor:pointer;font-size:16px;color:#fff;font-weight:600;}

    .social-icons{display:flex;justify-content:center;}
    .social-icons a{display:inline-flex;padding:10px;border:2px solid #ccc;border-radius:8px;font-size:24px;color:#333;margin:0 8px;}

    .toggle-box{position:absolute;width:100%;height:100%;}
    .toggle-box::before{content:'';position:absolute;left:-250%;width:300%;height:100%;background:#7494ec;border-radius:150px;z-index:2;transition:1.8s ease-in-out;}
    .container.active .toggle-box::before{left:50%;}

    .toggle-panel{position:absolute;width:50%;height:100%;color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:2;transition:.6s ease-in-out;}
    .toggle-panel.toggle-left{left:0;transition-delay:1.2s;}
    .container.active .toggle-panel.toggle-left{left:-50%;transition-delay:.6s;}
    .toggle-panel.toggle-right{right:-50%;transition-delay:.6s;}
    .container.active .toggle-panel.toggle-right{right:0;transition-delay:1.2s;}
    .toggle-panel p{margin-bottom:20px;}
    .toggle-panel .btn{width:160px;height:46px;background:transparent;border:2px solid #fff;box-shadow:none;}

    .error{display:block;margin-top:8px;color:#e74c3c;font-size:12.5px;min-height:16px;}

    @media screen and (max-width:650px){
      .container{height:calc(100vh - 40px);}
      .form-box{bottom:0;width:100%;height:70%;}
      .container.active .form-box{right:0;bottom:30%;}
      .toggle-box::before{left:0;top:-270%;width:100%;height:300%;border-radius:20vw;}
      .container.active .toggle-box::before{left:0;top:70%;}
      .container.active .toggle-panel.toggle-left{left:0;top:-30%;}
      .toggle-panel{width:100%;height:30%;}
      .toggle-panel.toggle-left{top:0;}
      .toggle-panel.toggle-right{right:0;bottom:-30%;}
      .container.active .toggle-panel.toggle-right{bottom:0;}
    }
    @media screen and (max-width:400px){
      .form-box{padding:20px;}
      .toggle-panel h1{font-size:30px;}
    }

    /* ======= (إضافة الأمواج — بدون حذف أي شيء) ======= */
    @keyframes move_wave {
      0% { transform: translateX(0) translateZ(0) scaleY(1) }
      50% { transform: translateX(-25%) translateZ(0) scaleY(0.55) }
      100% { transform: translateX(-50%) translateZ(0) scaleY(1) }
    }
    .waveWrapper{
      overflow:hidden; position:fixed; left:0; right:0; bottom:0; top:0; margin:auto;
      z-index:0; pointer-events:none;
    }
    .waveWrapperInner{
      position:absolute; width:100%; height:100%; bottom:-1px; overflow:hidden;
      /* الألوان الأصلية للأمواج */
      background-image:linear-gradient(to top, #86377b 20%, #27273c 80%);
    }
    .bgTop{ z-index:15; opacity:.5; }
    .bgMiddle{ z-index:10; opacity:.75; }
    .bgBottom{ z-index:5; }
    .wave{
      position:absolute; left:0; width:200%; height:100%;
      background-repeat:repeat no-repeat; background-position:0 bottom;
      transform-origin:center bottom; will-change:transform;
    }
    .waveTop{ background-size:50% 100px; }
    .waveAnimation .waveTop{
      /* في كودك كان في اسم move-wave؛ نخلي الاثنين يعملان */
      animation: move_wave 3s linear infinite;
      -webkit-animation: move_wave 3s linear infinite;
      -webkit-animation-delay: 1s; animation-delay: 1s;
    }
    .waveMiddle{ background-size:50% 120px; }
    .waveAnimation .waveMiddle{ animation: move_wave 10s linear infinite; }
    .waveBottom{ background-size:50% 100px; }
    .waveAnimation .waveBottom{ animation: move_wave 15s linear infinite; }

    /* تأكيد أن الصندوق فوق الأمواج */
    .container{ z-index:3; }
    html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  background: none;
}

body {
  background: linear-gradient(180deg, #1e1e30 0%, #9b59b6 100%);
  overflow-x: hidden;
}

.waveWrapper {
  position: fixed;
  top: 0; 
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1; /* يخليها خلف المحتوى */
}

  </style>

</head>
<body>
  <div class="container" id="container">
    <!-- تسجيل الدخول -->
    <div class="form-box login">
      <form id="loginForm" novalidate>
        <h1>تسجيل الدخول</h1>
        <div class="input-box">
          <input id="loginEmail" type="email" placeholder="البريد الإلكتروني" required>
          <i class='bx bxs-envelope'></i>
        </div>
        <div class="input-box">
          <input id="loginPassword" type="password" placeholder="كلمة المرور" required>
          <i class='bx bxs-lock-alt'></i>
        </div>
        <div class="forgot-link"><a href="#" id="forgotLink">نسيت كلمة المرور؟</a></div>
        <button type="submit" class="btn" id="loginBtn">دخول</button>
        <p>أو سجّل الدخول عبر</p>
        <div class="social-icons">
          <a href="#"><i class='bx bxl-google'></i></a>
          <a href="#"><i class='bx bxl-facebook'></i></a>
          <a href="#"><i class='bx bxl-github'></i></a>
          <a href="#"><i class='bx bxl-linkedin'></i></a>
        </div>
        <small class="error" id="login-error"></small>
      </form>
    </div>

    <!-- التسجيل -->
    <div class="form-box register">
      <form id="registerForm" novalidate>
        <h1>إنشاء حساب</h1>
        <div class="input-box">
          <input id="regName" type="text" placeholder="الاسم الكامل" required>
          <i class='bx bxs-user'></i>
        </div>
        <div class="input-box">
          <input id="regEmail" type="email" placeholder="البريد الإلكتروني" required>
          <i class='bx bxs-envelope'></i>
        </div>
        <div class="input-box">
          <input id="regPassword" type="password" placeholder="كلمة المرور (8+)" required>
          <i class='bx bxs-lock-alt'></i>
        </div>
        <button type="submit" class="btn" id="regBtn">تسجيل</button>
        <p>أو أنشئ حسابًا عبر</p>
        <div class="social-icons">
          <a href="#"><i class='bx bxl-google'></i></a>
          <a href="#"><i class='bx bxl-facebook'></i></a>
          <a href="#"><i class='bx bxl-github'></i></a>
          <a href="#"><i class='bx bxl-linkedin'></i></a>
        </div>
        <small class="error" id="register-error"></small>
      </form>
    </div>

    <!-- لوحات التبديل -->
    <div class="toggle-box">
      <div class="toggle-panel toggle-left">
        <h1>أهلًا وسهلًا 👋</h1>
        <p>ما عندك حساب؟</p>
        <button class="btn register-btn" id="toRegister">إنشاء حساب</button>
      </div>
      <div class="toggle-panel toggle-right">
        <h1>مرحبًا بعودتك!</h1>
        <p>لديك حساب بالفعل؟</p>
        <button class="btn login-btn" id="toLogin">تسجيل الدخول</button>
      </div>
    </div>
  </div>

  <!-- ===== خلفية الأمواج (كما أرسلتها) ===== -->
  <div class="waveWrapper waveAnimation">
    <div class="waveWrapperInner bgTop">
      <div class="wave waveTop" style="background-image: url('http://front-end-noobs.com/jecko/img/wave-top.png')"></div>
    </div>
    <div class="waveWrapperInner bgMiddle">
      <div class="wave waveMiddle" style="background-image: url('http://front-end-noobs.com/jecko/img/wave-mid.png')"></div>
    </div>
    <div class="waveWrapperInner bgBottom">
      <div class="wave waveBottom" style="background-image: url('http://front-end-noobs.com/jecko/img/wave-bot.png')"></div>
    </div>
  </div>

  <script>
    /* ===== (جافاسكربت الأصلية كما هي) ===== */
    const container = document.getElementById('container');
    document.getElementById('toRegister').addEventListener('click',()=>container.classList.add('active'));
    document.getElementById('toLogin').addEventListener('click',()=>container.classList.remove('active'));

    const WEBHOOK_URL = 'https://YOUR_N8N_WEBHOOK_URL/login-or-register'; // غيّره

    const isEmail = (v)=>/^\S+@\S+\.\S+$/.test(v);
    const min8 = (v)=>typeof v==="string"&&v.length>=8;

    async function callN8N(payload){
      const res = await fetch(WEBHOOK_URL,{
        method:'POST',headers:{'Content-Type':'application/json'},
        body:JSON.stringify(payload)
      });
      const data = await res.json().catch(()=>({}));
      if(!res.ok) throw new Error(data.error||'REQUEST_FAILED');
      return data;
    }

    // Login
    document.getElementById('loginForm').addEventListener('submit',async e=>{
      e.preventDefault();
      const email=document.getElementById('loginEmail').value.trim();
      const password=document.getElementById('loginPassword').value;
      const err=document.getElementById('login-error');
      const btn=document.getElementById('loginBtn');
      err.textContent='';
      if(!isEmail(email)) return err.textContent='رجاءً أدخل بريدًا صحيحًا';
      if(!min8(password)) return err.textContent='كلمة المرور 8 أحرف على الأقل';
      const original=btn.textContent;btn.disabled=true;btn.textContent='...جارٍ الدخول';
      try{
        const fp=navigator.userAgent||'web';
        const data=await callN8N({action:'login',email,password,fingerprint:fp,locale:'ar',source:'web'});
        if(!data.ok) throw new Error(data.error||'LOGIN_FAILED');
        if(data.token) localStorage.setItem('mb_token',data.token);
        window.location.href=data.redirect||'/';
      }catch(e2){err.textContent=e2.message==='INVALID_CREDENTIALS'?'بيانات الدخول غير صحيحة':'تعذّر تسجيل الدخول';}
      finally{btn.disabled=false;btn.textContent=original;}
    });

    // Register
    document.getElementById('registerForm').addEventListener('submit',async e=>{
      e.preventDefault();
      const name=document.getElementById('regName').value.trim();
      const email=document.getElementById('regEmail').value.trim();
      const password=document.getElementById('regPassword').value;
      const err=document.getElementById('register-error');
      const btn=document.getElementById('regBtn');
      err.textContent='';
      if(name.length<2) return err.textContent='أدخل اسمًا صالحًا';
      if(!isEmail(email)) return err.textContent='رجاءً أدخل بريدًا صحيحًا';
      if(!min8(password)) return err.textContent='كلمة المرور 8 أحرف على الأقل';
      const original=btn.textContent;btn.disabled=true;btn.textContent='...جارٍ التسجيل';
      try{
        const fp=navigator.userAgent||'web';
        const data=await callN8N({action:'register',name,email,password,fingerprint:fp,locale:'ar',source:'web'});
        if(!data.ok) throw new Error(data.error||'REGISTER_FAILED');
        if(data.token) localStorage.setItem('mb_token',data.token);
        window.location.href=data.redirect||'/';
      }catch(e2){err.textContent=e2.message==='EMAIL_IN_USE'?'هذا البريد مستخدم مسبقًا':'تعذّر إنشاء الحساب';}
      finally{btn.disabled=false;btn.textContent=original;}
    });

    document.getElementById('forgotLink').addEventListener('click',e=>{
      e.preventDefault();
      alert('هنضيف استرجاع كلمة المرور عبر n8n لاحقًا.');
    });
  </script>
</body>
</html>
